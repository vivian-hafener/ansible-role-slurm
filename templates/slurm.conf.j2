# slurm.conf
# Managed by Ansible - DO NOT CHANGE

# Controller
ClusterName={{ slurm_cluster_name }}
SlurmctldHost={{ slurmctld_host }}
{% if slurm_control_addr is defined %}
SlurmctldAddr={{ slurm_control_addr }}
{% endif %}
SlurmctldPort={{ slurmctld_port }}
SlurmctldPidFile={{ slurmctld_pid_file }}

# Users
SlurmUser={{ slurm_user }}

# Slurmd 
SlurmdPort={{ slurmd_port }}
SlurmdPidFile={{ slurmd_pid_file }}

# MPI
MpiDefault={{ slurm_mpi_default }}
{% if slurm_mpi_params is defined %}
MpiParams={{ slurm_mpi_params }}
{% endif %}

# Cluster configuration
StateSaveLocation={{ slurm_state_dir }}
SwitchType={{ slurm_switch_type }}
ProctrackType={{ slurm_proctrack_type }}
FirstJobId={{ slurm_first_job_id }}
ReturnToService={{ slurm_return_to_service }}
TaskPlugin={{ slurm_task_plugin }}

{% if slurm_jobsubmitplugins is defined %}
JobSubmitPlugins={{ slurm_jobsubmitplugins }}
{% endif %}

{% if slurm_with_gpu == true %}
GresTypes={{ slurm_grestypes }}
{% endif %}

# TIMERS
SlurmctldTimeout={{ slurmctld_timeout }}
SlurmdTimeout={{ slurmd_timeout }}
InactiveLimit={{ slurm_inactive_limit }}
MinJobAge={{ slurm_minjobage }}
MessageTimeout={{ slurm_message_timeout }}
KillWait={{ slurm_kill_wait }}
Waittime={{ slurm_wait_time }}


# SCHEDULING
SchedulerType={{ slurm_sched_type }}
{% if slurm_sched_params is defined %}
SchedulerParameters={{ slurm_sched_params }}
{% endif %}
SelectType={{ slurm_select_type }}

# Debugging
SlurmctldDebug={{ slurmctld_debug }}
SlurmdDebug={{ slurmd_debug }}
{% if slurm_debug_flags is defined %}
DebugFlags={{ slurm_debug_flags }}
{% endif %}

# ACCOUNTING
AccountingStorageType={{ slurm_accounting_storage_type }}
AccountingStorageHost={{ slurm_dbd_host }}

# TOPOLOGY
{% if slurm_with_topo is defined %}
TopologyPlugin={{ slurm_topology_plugin }}
{% else %}
#TopologyPlugin=topology/tree
{% endif %}

# COMPUTE NODES
{% if slurm_nodelist is defined %}
{% for nodelist in slurm_nodelist %}
{{ nodelist }}
{% endfor %}
{% else %}
{% endif %}

# partitions
{% if slurm_partitionlist is defined %}
{% for partition in slurm_partitionlist %}
{{ partition }}
{% endfor %}
{% else %}
PartitionName=debug Nodes=ALL Default=YES MaxTime=INFINITE State=UP
{% endif %}

# Slurm Extra Parameters
{% if slurm_ExtraParamsList is defined %}
{% for slurm_Param in slurm_ExtraParamsList %}
{{ slurm_Param }}
{% endfor %}
{% endif %}

{% if slurm_conf_version_specific_params_list is defined %}
# Slurm Version Specific Parameters
{% for slurm_v_param in slurm_conf_version_specific_params_list %}
{{ slurm_v_param }}
{% endfor %}
{% endif %}
